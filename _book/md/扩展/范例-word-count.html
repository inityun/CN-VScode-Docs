
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>范例-word-count · vscode-docs</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="VSCodeContributorsinChina">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-intopic-toc/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="范例-language-server.html" />
    
    
    <link rel="prev" href="范例-hello-world.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://code.visualstudio.com/docs">
            
                    
                    官方文档
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../Overview.html">
            
                <a href="../Overview.html">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../快速入门.md">
            
                <span>
            
                    
                    快速入门(暂无)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../快速入门/介绍视频.html">
            
                <a href="../快速入门/介绍视频.html">
            
                    
                    视频介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../快速入门/小技巧.html">
            
                <a href="../快速入门/小技巧.html">
            
                    
                    小技巧
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../快速入门/用户接口.html">
            
                <a href="../快速入门/用户接口.html">
            
                    
                    用户接口
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../快速入门/主题.html">
            
                <a href="../快速入门/主题.html">
            
                    
                    主题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../快速入门/设置.html">
            
                <a href="../快速入门/设置.html">
            
                    
                    设置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../快速入门/快捷键绑定.html">
            
                <a href="../快速入门/快捷键绑定.html">
            
                    
                    快捷键绑定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../快速入门/语言区域.html">
            
                <a href="../快速入门/语言区域.html">
            
                    
                    语言区域
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../summary/编辑器.html">
            
                <a href="../../summary/编辑器.html">
            
                    
                    编辑器
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../编辑器/基础.html">
            
                <a href="../编辑器/基础.html">
            
                    
                    基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../编辑器/安装.html">
            
                <a href="../编辑器/安装.html">
            
                    
                    安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../编辑器/扩展市场.html">
            
                <a href="../编辑器/扩展市场.html">
            
                    
                    扩展市场
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../编辑器/任务.html">
            
                <a href="../编辑器/任务.html">
            
                    
                    任务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../编辑器/调试.html">
            
                <a href="../编辑器/调试.html">
            
                    
                    调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../编辑器/为什么选用VSCode.html">
            
                <a href="../编辑器/为什么选用VSCode.html">
            
                    
                    为什么选用VSCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../编辑器/版本控制.html">
            
                <a href="../编辑器/版本控制.html">
            
                    
                    版本控制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../编辑器/易用性.html">
            
                <a href="../编辑器/易用性.html">
            
                    
                    易用性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../编辑器/与时俱进的编辑体验.html">
            
                <a href="../编辑器/与时俱进的编辑体验.html">
            
                    
                    与时俱进的编辑体验
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../summary/定制化.html">
            
                <a href="../../summary/定制化.html">
            
                    
                    定制化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../定制化/概述.html">
            
                <a href="../定制化/概述.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../定制化/用户和工作空间.html">
            
                <a href="../定制化/用户和工作空间.html">
            
                    
                    用户和工作空间
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../定制化/快捷键绑定.html">
            
                <a href="../定制化/快捷键绑定.html">
            
                    
                    快捷键绑定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../定制化/用户定义代码段.html">
            
                <a href="../定制化/用户定义代码段.html">
            
                    
                    用户定义代码段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../定制化/调色板.html">
            
                <a href="../定制化/调色板.html">
            
                    
                    调色板
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../定制化/主题.html">
            
                <a href="../定制化/主题.html">
            
                    
                    主题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../定制化/语言区域.html">
            
                <a href="../定制化/语言区域.html">
            
                    
                    语言区域
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../summary/工具.html">
            
                <a href="../../summary/工具.html">
            
                    
                    工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../工具/vse命令行工具.html">
            
                <a href="../工具/vse命令行工具.html">
            
                    
                    vse命令行工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../工具/yocode扩展生成器.html">
            
                <a href="../工具/yocode扩展生成器.html">
            
                    
                    yocode扩展生成器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../工具/范例.html">
            
                <a href="../工具/范例.html">
            
                    
                    范例
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../summary/技术支持.html">
            
                <a href="../../summary/技术支持.html">
            
                    
                    技术支持
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../技术支持/常见问题.html">
            
                <a href="../技术支持/常见问题.html">
            
                    
                    常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../技术支持/错误代码.html">
            
                <a href="../技术支持/错误代码.html">
            
                    
                    错误代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../技术支持/如何升级.html">
            
                <a href="../技术支持/如何升级.html">
            
                    
                    如何升级
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../技术支持/系统要求.html">
            
                <a href="../技术支持/系统要求.html">
            
                    
                    系统要求
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../summary/扩展.html">
            
                <a href="../../summary/扩展.html">
            
                    
                    扩展
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="概述.html">
            
                <a href="概述.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="范例-hello-world.html">
            
                <a href="范例-hello-world.html">
            
                    
                    范例-hello-world
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9.3" data-path="范例-word-count.html">
            
                <a href="范例-word-count.html">
            
                    
                    范例-word-count
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="范例-language-server.html">
            
                <a href="范例-language-server.html">
            
                    
                    范例-language-server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="范例-调试器.html">
            
                <a href="范例-调试器.html">
            
                    
                    范例-调试器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="调试-扩展.html">
            
                <a href="调试-扩展.html">
            
                    
                    调试-扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="安装-扩展.html">
            
                <a href="安装-扩展.html">
            
                    
                    安装-扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="范式-原则.html">
            
                <a href="范式-原则.html">
            
                    
                    范式-原则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="测试-扩展.html">
            
                <a href="测试-扩展.html">
            
                    
                    测试-扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="用我们的方法创造扩展.html">
            
                <a href="用我们的方法创造扩展.html">
            
                    
                    用我们的方法创造扩展
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../summary/扩展API.html">
            
                <a href="../../summary/扩展API.html">
            
                    
                    扩展API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../扩展API/概述.html">
            
                <a href="../扩展API/概述.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../扩展API/扩展manifest文件.html">
            
                <a href="../扩展API/扩展manifest文件.html">
            
                    
                    扩展manifest文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../扩展API/扩展点.html">
            
                <a href="../扩展API/扩展点.html">
            
                    
                    扩展点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../扩展API/激活事件.html">
            
                <a href="../扩展API/激活事件.html">
            
                    
                    激活事件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../扩展API/vscode-api.html">
            
                <a href="../扩展API/vscode-api.html">
            
                    
                    vscode-api
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../扩展API/vscode-api-命令.html">
            
                <a href="../扩展API/vscode-api-命令.html">
            
                    
                    vscode-api-命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../扩展API/api调试.html">
            
                <a href="../扩展API/api调试.html">
            
                    
                    api调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../../summary/语言.html">
            
                <a href="../../summary/语言.html">
            
                    
                    语言
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../语言/概述.html">
            
                <a href="../语言/概述.html">
            
                    
                    概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../语言/javascript.html">
            
                <a href="../语言/javascript.html">
            
                    
                    Javascript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../语言/json.html">
            
                <a href="../语言/json.html">
            
                    
                    JSON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../语言/html.html">
            
                <a href="../语言/html.html">
            
                    
                    HTML(暂无)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../语言/css.html">
            
                <a href="../语言/css.html">
            
                    
                    CSS, Sass and Less
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../语言/typescript.html">
            
                <a href="../语言/typescript.html">
            
                    
                    TypeScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="../语言/markdown.html">
            
                <a href="../语言/markdown.html">
            
                    
                    Markdown
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8" data-path="../语言/cpp.html">
            
                <a href="../语言/cpp.html">
            
                    
                    C++
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="../语言/java.md">
            
                <span>
            
                    
                    Java(暂无)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.10" data-path="../语言/php.html">
            
                <a href="../语言/php.html">
            
                    
                    PHP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.11" data-path="../语言/python.html">
            
                <a href="../语言/python.html">
            
                    
                    Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.12" data-path="../语言/go.md">
            
                <span>
            
                    
                    Go(暂无)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.13" data-path="../语言/dockerfile.html">
            
                <a href="../语言/dockerfile.html">
            
                    
                    Dockerfile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.14" data-path="../语言/t-sql.md">
            
                <span>
            
                    
                    T-SQL(暂无)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.15" data-path="../语言/csharp.html">
            
                <a href="../语言/csharp.html">
            
                    
                    C#
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../../summary/运行时.html">
            
                <a href="../../summary/运行时.html">
            
                    
                    运行时
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../运行时/nodejs.html">
            
                <a href="../运行时/nodejs.html">
            
                    
                    nodejs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../运行时/ASPnet5.html">
            
                <a href="../运行时/ASPnet5.html">
            
                    
                    ASPnet5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../运行时/unity.html">
            
                <a href="../运行时/unity.html">
            
                    
                    unity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../运行时/office.html">
            
                <a href="../运行时/office.html">
            
                    
                    office
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >范例-word-count</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x793A;&#x4F8B;---&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;--example---word-count">&#x793A;&#x4F8B; - &#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;  Example - Word Count</h1>
<p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5047;&#x5B9A;&#x4F60;&#x5DF2;&#x7ECF;&#x8BFB;&#x4E86;&#x4E4B;&#x524D;&#x8BB2;&#x8FF0;VS Code&#x63D2;&#x4EF6;&#x57FA;&#x672C;&#x77E5;&#x8BC6;&#x7684;&#x6587;&#x7AE0;<a href="../../docs/extensions/example-hello-world.md">&#x4F60;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;</a>&#x3002;</p>
<p>&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x662F;&#x4E00;&#x7BC7;&#x624B;&#x628A;&#x624B;&#x6559;&#x4F60;&#x600E;&#x6837;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x8F85;&#x52A9;&#x7F16;&#x5199;Markdown&#x7684;&#x63D2;&#x4EF6;&#x7684;&#x7684;&#x6559;&#x7A0B;&#xFF0C;&#x5728;&#x4F60;&#x4E86;&#x89E3;&#x8FD9;&#x4E2A;&#x63D2;&#x4EF6;&#x6240;&#x6709;&#x7684;&#x8FD0;&#x884C;&#x7EC6;&#x8282;&#x524D;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x63D2;&#x4EF6;&#x7684;&#x6838;&#x5FC3;&#x529F;&#x80FD;&#x7684;&#x6548;&#x679C;&#x6F14;&#x793A;&#x3002;</p>
<p>&#x53EA;&#x8981;&#x5F53;<code>Markdown</code>&#x6587;&#x4EF6;&#x6B63;&#x5728;&#x88AB;&#x7F16;&#x8F91;&#xFF0C;&#x72B6;&#x6001;&#x680F;&#x4E0A;&#x5C31;&#x4F1A;&#x6DFB;&#x52A0;&#x6587;&#x6863;&#x5355;&#x8BCD;&#x6570;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x8FD9;&#x4E2A;&#x4FE1;&#x606F;&#x5C06;&#x968F;&#x7740;&#x4F60;&#x7684;&#x952E;&#x5165;&#x6216;&#x8005;&#x6253;&#x5F00;&#x5176;&#x4ED6;&#x6587;&#x4EF6;&#x800C;&#x968F;&#x4E4B;&#x53D8;&#x5316;&#xFF1A;</p>
<p><img src="images/example-word-count/wordcountevent2.gif" alt="&#x72B6;&#x6001;&#x680F;&#x4E0A;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;"></p>
<blockquote>
<p><strong>&#x5C0F;&#x8D34;&#x58EB;&#xFF1A;</strong>&#x8FD9;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x63D2;&#x4EF6;&#x5B9E;&#x4F8B;&#x5728;<a href="https://github.com/microsoft/vscode-wordcount" target="_blank">&#x8FD9;&#x4E2A;GitHub&#x4ED3;&#x5E93;</a>&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6709;&#x4EFB;&#x4F55;&#x7684;&#x95EE;&#x9898;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x63D0;&#x51FA;&#x6765;&#x3002;</p>
</blockquote>
<p>This document assumes you have read <a href="../../docs/extensions/example-hello-world.md">Your First Extension</a> which covers the basics of VS Code extensibility.</p>
<p>Word Count is an end to end tutorial to show you how to create an extension to aid in Markdown authoring.  Before we get into how all of this works, let&apos;s have a quick demo of the core features you will be building so you know what to expect.</p>
<p>Whenever a <code>Markdown</code> file is edited, a status bar message is added.  The message includes the current word count and updates as you type and move from file to file:</p>
<p><img src="images/example-word-count/wordcountevent2.gif" alt="Word Count on Status Bar"></p>
<blockquote>
<p><strong>Tip:</strong> The finished sample is available from <a href="https://github.com/microsoft/vscode-wordcount" target="_blank">this GitHub repository</a> should you have any issues.</p>
</blockquote>
<h2 id="&#x6982;&#x8FF0;--overview">&#x6982;&#x8FF0;  Overview</h2>
<p>&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x5C06;&#x5206;&#x4E09;&#x8282;&#x6765;&#x544A;&#x8BC9;&#x4F60;&#x4E00;&#x7CFB;&#x5217;&#x76F8;&#x5173;&#x8054;&#x7684;&#x6982;&#x5FF5;&#xFF1A;</p>
<ol>
<li><a href="../../docs/extensions/example-word-count.md#update-the-status-bar">&#x66F4;&#x65B0;&#x72B6;&#x6001;&#x680F;</a> - &#x5728;VS Code&#x7684;<code>&#x72B6;&#x6001;&#x680F;</code>&#x4E0A;&#x663E;&#x793A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6587;&#x5B57;</li>
<li><a href="../../docs/extensions/example-word-count.md#subscribing-to-events">&#x8BA2;&#x9605;&#x4E8B;&#x4EF6;&#x901A;&#x77E5;</a> - &#x57FA;&#x4E8E;&#x7F16;&#x8F91;&#x5668;&#x7684;&#x4E8B;&#x4EF6;&#x66F4;&#x65B0;<code>&#x72B6;&#x6001;&#x680F;</code></li>
<li><a href="../../docs/extensions/example-word-count.md#disposing-extension-resources">&#x9500;&#x6BC1;&#x63D2;&#x4EF6;&#x8D44;&#x6E90;</a> - &#x91CA;&#x653E;&#x65F6;&#x4E8B;&#x4EF6;&#x8BA2;&#x9605;&#x4EE5;&#x53CA;&#x754C;&#x9762;&#x5143;&#x7D20;&#x53E5;&#x67C4;&#x4E4B;&#x7C7B;&#x7684;&#x8D44;&#x6E90;</li>
</ol>
<p>&#x9996;&#x5148;&#x786E;&#x4FDD;&#x4F60;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;&#x4E86;&#x6700;&#x65B0;&#x7684;VS Code&#x63D2;&#x4EF6;&#x751F;&#x6210;&#x5668;&#x5E76;&#x8FD0;&#x884C;&#x5B83;&#xFF1A;</p>
<pre><code class="lang-bash">npm install -g yo generator-code
yo code
</code></pre>
<p>&#x8FD9;&#x5C06;&#x4F1A;&#x6253;&#x5F00;&#x63D2;&#x4EF6;&#x751F;&#x6210;&#x5668; - &#x6211;&#x4EEC;&#x9009;&#x62E9;TypeScript <code>New Extension</code>&#x9009;&#x9879;&#x3002;&#x73B0;&#x5728;&#x540C;&#x6837;&#x7B80;&#x5355;&#x5730;&#x586B;&#x5199;&#x4E0B;&#x65B9;&#x56FE;&#x7247;&#x4E0A;&#x5B8C;&#x6210;&#x586B;&#x5199;&#x7684;&#x90A3;&#x4E9B;&#x6210;&#x5458;&#xFF08;&#x4F7F;&#x7528;&apos;WordCount&apos;&#x4F5C;&#x4E3A;&#x63D2;&#x4EF6;&#x7684;&#x540D;&#x5B57;&#x5E76;&#x4E14;&#x7528;&#x4F60;&#x7684;&#x540D;&#x5B57;&#x4F5C;&#x4E3A;&#x53D1;&#x5E03;&#x8005;&#xFF09;&#x3002;</p>
<p><img src="images/example-word-count/yo1.png" alt="&#x751F;&#x6210;Word Count&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7684;&#x8F93;&#x51FA;"></p>
<p>&#x73B0;&#x5728;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x751F;&#x6210;&#x5668;&#x63CF;&#x8FF0;&#x7684;&#x8F93;&#x51FA;&#x76EE;&#x5F55;&#x91CC;&#x6253;&#x5F00;VS Code&#xFF1A;</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> WordCount
code .
</code></pre>
<p>This example has three sections which will take you through a set of related concepts:</p>
<ol>
<li><a href="../../docs/extensions/example-word-count.md#update-the-status-bar">Update the Status Bar</a> - display custom text in the VS Code <code>Status Bar</code></li>
<li><a href="../../docs/extensions/example-word-count.md#subscribing-to-events">Subscribing to Events</a> - updating the <code>Status Bar</code> based on editor events</li>
<li><a href="../../docs/extensions/example-word-count.md#disposing-extension-resources">Disposing Extension Resources</a> - release resources like event subscriptions or UI handles</li>
</ol>
<p>First make sure you have the latest VS Code extension generator installed then run it:</p>
<pre><code class="lang-bash">npm install -g yo generator-code
yo code
</code></pre>
<p>This will open up the extension generator - we will base this example on the TypeScript <code>New Extension</code> option. For now, simply fill in the fields the same way you see them completed in the image below (using &apos;WordCount&apos; as the extension name and your own name as the publisher).</p>
<p><img src="images/example-word-count/yo1.png" alt="Yo Code Word Count Example Output"></p>
<p>You can now open VS Code as described in the generator output:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> WordCount
code .
</code></pre>
<h2 id="&#x8FD0;&#x884C;&#x63D2;&#x4EF6;--run-the-extension">&#x8FD0;&#x884C;&#x63D2;&#x4EF6;  Run the Extension</h2>
<p>&#x5728;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x4E0B;&#x4E00;&#x6B65;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5148;&#x6309;&#x4E0B;<code>kb(workbench.action.debug.start)</code>&#x8FD0;&#x884C;&#x4E00;&#x4E0B;&#x63D2;&#x4EF6;&#x4EE5;&#x786E;&#x4FDD;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x4E00;&#x5207;&#x6B63;&#x5E38;&#x3002;&#x5982;&#x540C;&#x4F60;&#x5728;&#x4E4B;&#x524D;&quot;Hello World&quot;&#x6559;&#x7A0B;&#x4E2D;&#x770B;&#x5230;&#x7684;&#x90A3;&#x6837;&#xFF0C;VS Code&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;&#x540E;&#x6253;&#x5F00;&#x53E6;&#x4E00;&#x4E2A;&#x7A97;&#x53E3;&#xFF08;<strong>[&#x6269;&#x5C55;&#x5F00;&#x53D1;&#x4E3B;&#x673A;]</strong>&#x7A97;&#x53E3;&#xFF09;&#x3002;&#x4F60;&#x5E94;&#x8BE5;&#x5728;&#x547D;&#x4EE4;&#x9762;&#x677F;&#x627E;&#x5230;&quot;Hello World&quot;&#x547D;&#x4EE4;&#xFF08;&#x6309;&#x4E0B;<code>kb(workbench.action.showCommands)</code>&#xFF09;&#x5E76;&#x9009;&#x62E9;&#x5B83;&#xFF0C;&#x4F60;&#x5C06;&#x4F1A;&#x5728;&#x770B;&#x5230;&#x7A97;&#x53E3;&#x9876;&#x90E8;&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x663E;&#x793A;&quot;Hello World&quot;&#x7684;&#x6D88;&#x606F;&#x63D0;&#x793A;&#x6846;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x4F60;&#x5DF2;&#x7ECF;&#x786E;&#x5B9A;&#x4E86;&#x63D2;&#x4EF6;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x7684;&#x8FD0;&#x884C;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x559C;&#x6B22;&#x4F60;&#x53EF;&#x4EE5;&#x8BA9;&#x63D2;&#x4EF6;&#x5F00;&#x53D1;&#x7A97;&#x53E3;&#x4FDD;&#x6301;&#x6253;&#x5F00; &#x3002;&#x63A5;&#x4E0B;&#x6765;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5F00;&#x53D1;&#x7A97;&#x53E3;&#x4E2D;&#x518D;&#x6B21;&#x6309;&#x4E0B;<code>kb(workbench.action.debug.continue)</code>&#x6216;&#x8005;&#x6309;&#x4E0B;<code>kbstyle(Ctrl+R)</code> (Mac: <code>kbstyle(Cmd+R)</code>)&#x6765;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;&#x5F00;&#x53D1;&#x7A97;&#x53E3;&#x4EE5;&#x786E;&#x5B9A;&#x4F60;&#x5BF9;&#x63D2;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x751F;&#x6548;&#x4E86;&#x3002;</p>
<p>Before we go on, we can run the extension to make sure everything works as expected by pressing <code>kb(workbench.action.debug.start)</code>. As you saw in the previous &quot;Hello World&quot; walkthrough, VS Code opens another window (the <strong>[Extension Development Host]</strong> window) in which your extension will be loaded. You should find the &quot;Hello World&quot; command in the Command Palette (press <code>kb(workbench.action.showCommands)</code>) and when you select it, you will see an information box at the top of the window saying &quot;Hello World&quot;.</p>
<p>Now that you have confirmed that the extension is running properly, you can keep the extension development window open if you like. To test out any changes that you make to your extension, you can either press <code>kb(workbench.action.debug.continue)</code> again in the development window or reload the extension development window by pressing <code>kbstyle(Ctrl+R)</code> (Mac: <code>kbstyle(Cmd+R)</code>).</p>
<h2 id="&#x66F4;&#x65B0;&#x72B6;&#x6001;&#x680F;--update-the-status-bar">&#x66F4;&#x65B0;&#x72B6;&#x6001;&#x680F;  Update the Status Bar</h2>
<p>&#x5C06;&#x751F;&#x6210;&#x7684;<code>extension.ts</code>&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x66FF;&#x6362;&#x6210;&#x4E0B;&#x9762;&#x5C55;&#x793A;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x4EE3;&#x7801;&#x58F0;&#x660E;&#x5E76;&#x5B9E;&#x4F8B;&#x5316;&#x4E86;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x7EDF;&#x8BA1;&#x5355;&#x8BCD;&#x6570;&#x5E76;&#x4E14;&#x663E;&#x793A;&#x5728;VS Code&#x72B6;&#x6001;&#x680F;&#x4E0A;&#x7684;<code>WordCounter</code>&#x7C7B;&#x3002;&#x5F53;&quot;Hello Word&quot;&#x547D;&#x4EE4;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x8C03;&#x7528;<code>updateWordCount</code>&#x51FD;&#x6570;&#x3002;</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// &apos;vscode&apos;&#x6A21;&#x5757;&#x5305;&#x62EC;VS Code&#x63D2;&#x4EF6;API</span>
<span class="hljs-comment">// &#x5BFC;&#x5165;&#x4E0B;&#x9762;&#x4EE3;&#x7801;&#x4F7F;&#x7528;&#x7684;&#x5FC5;&#x5907;&#x7684;&#x63D2;&#x4EF6;&#x7C7B;&#x578B;</span>
<span class="hljs-keyword">import</span> {<span class="hljs-built_in">window</span>, commands, Disposable, ExtensionContext, StatusBarAlignment, StatusBarItem, TextDocument} <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;vscode&apos;</span>;

<span class="hljs-comment">// &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x5728;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#x88AB;&#x6FC0;&#x6D3B;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x6FC0;&#x6D3B;&#x662F;&#x7531;&#x5B9A;&#x4E49;&#x5728;</span>
<span class="hljs-comment">// package.json&#x6587;&#x4EF6;&#x4E2D;&#x7684;activation events&#x5B9A;&#x4E49;&#x7684;</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">activate</span>(<span class="hljs-params">context: ExtensionContext</span>) </span>{

    <span class="hljs-comment">// &#x4F7F;&#x7528;&#x63A7;&#x5236;&#x53F0;&#x53BB;&#x8F93;&#x51FA;&#x8BCA;&#x65AD;&#x4FE1;&#x606F;(console.log)&#x548C;&#x9519;&#x8BEF;&#x4FE1;&#x606F;(console.error)</span>
    <span class="hljs-comment">// &#x53EA;&#x6709;&#x5F53;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#x88AB;&#x6FC0;&#x6D3B;&#x65F6;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x8FD9;&#x884C;&#x4EE3;&#x7801;</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Congratulations, your extension &quot;WordCount&quot; is now active!&apos;</span>);

    <span class="hljs-comment">// &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x5BF9;&#x8C61;</span>
    <span class="hljs-keyword">let</span> wordCounter = <span class="hljs-keyword">new</span> WordCounter();

    <span class="hljs-keyword">var</span> disposable = commands.registerCommand(<span class="hljs-string">&apos;extension.sayHello&apos;</span>, () =&gt; {
        wordCounter.updateWordCount();
    });

    <span class="hljs-comment">// &#x6DFB;&#x52A0;&#x5230;&#x5F53;&#x63D2;&#x4EF6;&#x5173;&#x95ED;&#x65F6;&#x88AB;&#x6E05;&#x7406;&#x7684;&#x53EF;&#x6E05;&#x7406;&#x5217;&#x8868;</span>
    context.subscriptions.push(wordCounter);
    context.subscriptions.push(disposable);
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WordCounter</span> </span>{

    private _statusBarItem: StatusBarItem;

    public updateWordCount() {

        <span class="hljs-comment">// &#x521B;&#x5EFA;&#x6240;&#x9700;&#x7684;&#x72B6;&#x6001;&#x680F;&#x5143;&#x7D20;</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._statusBarItem) {
            <span class="hljs-keyword">this</span>._statusBarItem = <span class="hljs-built_in">window</span>.createStatusBarItem(StatusBarAlignment.Left);
        }

        <span class="hljs-comment">// &#x5F97;&#x5230;&#x5F53;&#x524D;&#x7684;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;</span>
        <span class="hljs-keyword">let</span> editor = <span class="hljs-built_in">window</span>.activeTextEditor;
        <span class="hljs-keyword">if</span> (!editor) {
            <span class="hljs-keyword">this</span>._statusBarItem.hide();
            <span class="hljs-keyword">return</span>;
        }

         <span class="hljs-keyword">let</span> doc = editor.document;

        <span class="hljs-comment">// &#x53EA;&#x6709;&#x5F53;&#x662F;Markdown&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#x624D;&#x66F4;&#x65B0;&#x72B6;&#x6001;</span>
        <span class="hljs-keyword">if</span> (doc.languageId === <span class="hljs-string">&quot;markdown&quot;</span>) {
            <span class="hljs-keyword">let</span> wordCount = <span class="hljs-keyword">this</span>._getWordCount(doc);

            <span class="hljs-comment">// &#x66F4;&#x65B0;&#x72B6;&#x6001;&#x680F;</span>
            <span class="hljs-keyword">this</span>._statusBarItem.text = wordCount !== <span class="hljs-number">1</span> ? <span class="hljs-string">`<span class="hljs-subst">${wordCount}</span> Words`</span> : <span class="hljs-string">&apos;1 Word&apos;</span>;
            <span class="hljs-keyword">this</span>._statusBarItem.show();
        } <span class="hljs-keyword">else</span> { 
            <span class="hljs-keyword">this</span>._statusBarItem.hide();
        }
    }

    public _getWordCount(doc: TextDocument): number {

        <span class="hljs-keyword">let</span> docContent = doc.getText();

        <span class="hljs-comment">// &#x53BB;&#x9664;&#x591A;&#x4F59;&#x7684;&#x7A7A;&#x683C;&#x4EE5;&#x65B9;&#x4FBF;&#x4E0E;&#x5206;&#x5272;</span>
        docContent = docContent.replace(<span class="hljs-regexp">/(&lt; ([^&gt;]+)&lt;)/g</span>, <span class="hljs-string">&apos;&apos;</span>).replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">&apos; &apos;</span>);
        docContent = docContent.replace(<span class="hljs-regexp">/^\s\s*/</span>, <span class="hljs-string">&apos;&apos;</span>).replace(<span class="hljs-regexp">/\s\s*$/</span>, <span class="hljs-string">&apos;&apos;</span>);
        <span class="hljs-keyword">let</span> wordCount = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (docContent != <span class="hljs-string">&quot;&quot;</span>) {
            wordCount = docContent.split(<span class="hljs-string">&quot; &quot;</span>).length;
        }

        <span class="hljs-keyword">return</span> wordCount;
    }

    dispose() {
        <span class="hljs-keyword">this</span>._statusBarItem.dispose();
    }
}
</code></pre>
<p>&#x73B0;&#x5728;&#x8BA9;&#x6211;&#x4EEC;&#x8BD5;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x7684;&#x4FEE;&#x6539;&#x6709;&#x4EC0;&#x4E48;&#x6548;&#x679C;</p>
<p>&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x76D1;&#x89C6;TypeScript&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x5E76;&#x7F16;&#x8BD1;&#x7684;&#x4EFB;&#x52A1;(&#x5728;&#x63D2;&#x4EF6;&#x7684;.vscode\tasks.json&#x6587;&#x4EF6;&#x91CC;)&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x65E0;&#x9700;&#x624B;&#x52A8;&#x91CD;&#x65B0;&#x6784;&#x5EFA;&#x3002;&#x53EA;&#x9700;&#x8981;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x7684;&#x4EE3;&#x7801;&#x7684;<strong>[&#x6269;&#x5C55;&#x5F00;&#x53D1;&#x4E3B;&#x673A;]</strong>&#x7A97;&#x53E3;&#x91CC;&#x7B80;&#x5355;&#x7684;&#x6309;&#x4E0B;<code>kbstyle(Ctrl+R)</code>&#x5C31;&#x4F1A;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;&#xFF08;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x4E3B;&#x5F00;&#x53D1;&#x7A97;&#x53E3;&#x6309;<code>kb(workbench.action.debug.start)</code> &#xFF09;&#x3002;&#x6211;&#x4EEC;&#x4F9D;&#x7136;&#x9700;&#x8981;&#x50CF;&#x4E4B;&#x524D;&quot;Hello World&quot;&#x547D;&#x4EE4;&#x90A3;&#x6837;&#x6FC0;&#x6D3B;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x5982;&#x679C;&#x4F60;&#x73B0;&#x5728;&#x6253;&#x5F00;&#x7684;&#x662F;Markdown&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x7684;&#x72B6;&#x6001;&#x680F;&#x4E0A;&#x5C06;&#x4F1A;&#x663E;&#x793A;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x3002;</p>
<p><img src="images/example-word-count/wordcount2.png" alt="&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x63D2;&#x4EF6;"></p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x597D;&#x7684;&#x5F00;&#x59CB;&#xFF0C;&#x4F46;&#x662F;&#x7EDF;&#x8BA1;&#x8FD8;&#x4E0D;&#x80FD;&#x968F;&#x7740;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x7684;&#x4FEE;&#x6539;&#x800C;&#x53D8;&#x5316;&#x3002;</p>
<p>Replace the contents of the generated <code>extension.ts</code> file with the code shown below. It declares and instantiates a <code>WordCounter</code> class which can count words and shows them in the VS Code Status Bar.  The &quot;Hello Word&quot; command will call <code>updateWordCount</code> when invoked.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// The module &apos;vscode&apos; contains the VS Code extensibility API</span>
<span class="hljs-comment">// Import the necessary extensibility types to use in your code below</span>
<span class="hljs-keyword">import</span> {<span class="hljs-built_in">window</span>, commands, Disposable, ExtensionContext, StatusBarAlignment, StatusBarItem, TextDocument} <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;vscode&apos;</span>;

<span class="hljs-comment">// This method is called when your extension is activated. Activation is</span>
<span class="hljs-comment">// controlled by the activation events defined in package.json.</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">activate</span>(<span class="hljs-params">context: ExtensionContext</span>) </span>{

    <span class="hljs-comment">// Use the console to output diagnostic information (console.log) and errors (console.error).</span>
    <span class="hljs-comment">// This line of code will only be executed once when your extension is activated.</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Congratulations, your extension &quot;WordCount&quot; is now active!&apos;</span>);

    <span class="hljs-comment">// create a new word counter</span>
    <span class="hljs-keyword">let</span> wordCounter = <span class="hljs-keyword">new</span> WordCounter();

    <span class="hljs-keyword">var</span> disposable = commands.registerCommand(<span class="hljs-string">&apos;extension.sayHello&apos;</span>, () =&gt; {
        wordCounter.updateWordCount();
    });

    <span class="hljs-comment">// Add to a list of disposables which are disposed when this extension is deactivated.</span>
    context.subscriptions.push(wordCounter);
    context.subscriptions.push(disposable);
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WordCounter</span> </span>{

    private _statusBarItem: StatusBarItem;

    public updateWordCount() {

        <span class="hljs-comment">// Create as needed</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._statusBarItem) {
            <span class="hljs-keyword">this</span>._statusBarItem = <span class="hljs-built_in">window</span>.createStatusBarItem(StatusBarAlignment.Left);
        }

        <span class="hljs-comment">// Get the current text editor</span>
        <span class="hljs-keyword">let</span> editor = <span class="hljs-built_in">window</span>.activeTextEditor;
        <span class="hljs-keyword">if</span> (!editor) {
            <span class="hljs-keyword">this</span>._statusBarItem.hide();
            <span class="hljs-keyword">return</span>;
        }

         <span class="hljs-keyword">let</span> doc = editor.document;

        <span class="hljs-comment">// Only update status if an MarkDown file</span>
        <span class="hljs-keyword">if</span> (doc.languageId === <span class="hljs-string">&quot;markdown&quot;</span>) {
            <span class="hljs-keyword">let</span> wordCount = <span class="hljs-keyword">this</span>._getWordCount(doc);

            <span class="hljs-comment">// Update the status bar</span>
            <span class="hljs-keyword">this</span>._statusBarItem.text = wordCount !== <span class="hljs-number">1</span> ? <span class="hljs-string">`<span class="hljs-subst">${wordCount}</span> Words`</span> : <span class="hljs-string">&apos;1 Word&apos;</span>;
            <span class="hljs-keyword">this</span>._statusBarItem.show();
        } <span class="hljs-keyword">else</span> { 
            <span class="hljs-keyword">this</span>._statusBarItem.hide();
        }
    }

    public _getWordCount(doc: TextDocument): number {

        <span class="hljs-keyword">let</span> docContent = doc.getText();

        <span class="hljs-comment">// Parse out unwanted whitespace so the split is accurate</span>
        docContent = docContent.replace(<span class="hljs-regexp">/(&lt; ([^&gt;]+)&lt;)/g</span>, <span class="hljs-string">&apos;&apos;</span>).replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">&apos; &apos;</span>);
        docContent = docContent.replace(<span class="hljs-regexp">/^\s\s*/</span>, <span class="hljs-string">&apos;&apos;</span>).replace(<span class="hljs-regexp">/\s\s*$/</span>, <span class="hljs-string">&apos;&apos;</span>);
        <span class="hljs-keyword">let</span> wordCount = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (docContent != <span class="hljs-string">&quot;&quot;</span>) {
            wordCount = docContent.split(<span class="hljs-string">&quot; &quot;</span>).length;
        }

        <span class="hljs-keyword">return</span> wordCount;
    }

    dispose() {
        <span class="hljs-keyword">this</span>._statusBarItem.dispose();
    }
}
</code></pre>
<p>Now let&apos;s try our updates to the extension.</p>
<p>We have the compilation of the TypeScript file set on a watch (in the extension&apos;s .vscode\tasks.json file) so there is no need to re-build.  Simply hit <code>kbstyle(Ctrl+R)</code> in the <strong>[Extension Development Host]</strong> window where your code is running and the extension will reload (you can also just <code>kb(workbench.action.debug.start)</code> from your primary development window).  We still need to activate the code in the same way as before with the &quot;Hello World&quot; command.  Assuming you are in a Markdown file, your Status Bar will display the word count.</p>
<p><img src="images/example-word-count/wordcount2.png" alt="Working Word Count"></p>
<p>This is a good start but it would be cooler if the count updated as your file changed.</p>
<h2 id="&#x8BA2;&#x9605;&#x4E8B;&#x4EF6;--subscribing-to-events">&#x8BA2;&#x9605;&#x4E8B;&#x4EF6;  Subscribing to Events</h2>
<p>&#x8BA9;&#x6211;&#x4EEC;&#x7528;&#x4E00;&#x4E2A;&#x8F85;&#x52A9;&#x7C7B;&#x6765;&#x76D1;&#x542C;&#x8FD9;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</p>
<ul>
<li><code>onDidChangeTextEditorSelection</code> - &#x5F53;&#x5149;&#x6807;&#x4F4D;&#x7F6E;&#x6539;&#x53D8;&#x65F6;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;</li>
<li><code>onDidChangeActiveTextEditor</code> - &#x5F53;&#x88AB;&#x6FC0;&#x6D3B;&#x7684;&#x7F16;&#x8F91;&#x5668;&#x53D1;&#x751F;&#x6539;&#x53D8;&#x65F6;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;</li>
</ul>
<p>&#x8981;&#x5B8C;&#x6210;&#x8FD9;&#x4E00;&#x5207;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5411;<code>extension.ts</code>&#x6587;&#x4EF6;&#x91CC;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x65B0;&#x7C7B;&#x3002;&#x8FD9;&#x4E2A;&#x7C7B;&#x5C06;&#x8BA2;&#x9605;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x5E76;&#x4E14;&#x8BA9;<code>WordCounter</code>&#x5BF9;&#x8C61;&#x53BB;&#x66F4;&#x65B0;&#x5355;&#x8BCD;&#x7EDF;&#x8BA1;&#x6570;&#xFF0C;&#x540C;&#x65F6;&#x6CE8;&#x610F;&#x8FD9;&#x4E2A;&#x7C7B;&#x5728;&#x81EA;&#x5DF1;&#x88AB;&#x9500;&#x6BC1;&#x65F6;&#x600E;&#x6837;&#x53BB;&#x505C;&#x6B62;&#x76D1;&#x542C;&#x548C;&#x600E;&#x6837;&#x53BB;&#x7BA1;&#x7406;&#x8FD9;&#x4E9B;&#x8BA2;&#x9605;&#x7684;&#x9500;&#x6BC1;&#x3002;</p>
<p>&#x5728;<code>extension.ts</code>&#x6587;&#x4EF6;&#x7684;&#x5E95;&#x90E8;&#x52A0;&#x5165;&#x4E0B;&#x65B9;&#x663E;&#x793A;&#x7684;&#x4EE3;&#x7801;&#x6765;&#x6DFB;&#x52A0;<code>WordCounterController</code>&#x7C7B;&#x3002;</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WordCounterController</span> </span>{

    private _wordCounter: WordCounter;
    private _disposable: Disposable;

    <span class="hljs-keyword">constructor</span>(wordCounter: WordCounter) {
        <span class="hljs-keyword">this</span>._wordCounter = wordCounter;
        <span class="hljs-keyword">this</span>._wordCounter.updateWordCount();

        <span class="hljs-comment">// &#x8BA2;&#x9605;&#x9009;&#x62E9;&#x533A;&#x57DF;&#x53D8;&#x5316;&#x548C;&#x7F16;&#x8F91;&#x5668;&#x6FC0;&#x6D3B;&#x4E8B;&#x4EF6;</span>
        <span class="hljs-keyword">let</span> subscriptions: Disposable[] = [];
        <span class="hljs-built_in">window</span>.onDidChangeTextEditorSelection(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);
        <span class="hljs-built_in">window</span>.onDidChangeActiveTextEditor(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);

        <span class="hljs-comment">// &#x66F4;&#x65B0;&#x5F53;&#x524D;&#x6587;&#x4EF6;&#x7684;&#x7684;&#x5355;&#x8BCD;&#x6570;</span>
        <span class="hljs-keyword">this</span>._wordCounter.updateWordCount();

        <span class="hljs-comment">// &#x4ECE;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x8BA2;&#x9605;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Disposable&#x7C7B;&#x578B;&#x7684;&#x96C6;&#x5408;</span>
        <span class="hljs-keyword">this</span>._disposable = Disposable.from(...subscriptions);
    }

    dispose() {
        <span class="hljs-keyword">this</span>._disposable.dispose();
    }

    private _onEvent() {
        <span class="hljs-keyword">this</span>._wordCounter.updateWordCount();
    }
}
</code></pre>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x4E0D;&#x518D;&#x60F3;&#x8BA9;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x63D2;&#x4EF6;&#x5728;&#x8C03;&#x7528;&#x547D;&#x4EE4;&#x65F6;&#x624D;&#x88AB;&#x52A0;&#x8F7D;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x6253;&#x5F00;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;Markdown&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x88AB;&#x52A0;&#x8F7D;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x66FF;&#x6362;<code>activate</code>&#x51FD;&#x6570;</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// &#x4F7F;&#x7528;&#x63A7;&#x5236;&#x53F0;&#x53BB;&#x8F93;&#x51FA;&#x8BCA;&#x65AD;&#x4FE1;&#x606F;(console.log)&#x548C;&#x9519;&#x8BEF;&#x4FE1;&#x606F;(console.error)</span>
<span class="hljs-comment">// &#x53EA;&#x6709;&#x5F53;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#x88AB;&#x6FC0;&#x6D3B;&#x65F6;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x8FD9;&#x884C;&#x4EE3;&#x7801;</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Congratulations, your extension &quot;WordCount&quot; is now active!&apos;</span>);

<span class="hljs-comment">// &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x5BF9;&#x8C61;</span>
<span class="hljs-keyword">let</span> wordCounter = <span class="hljs-keyword">new</span> WordCounter();
<span class="hljs-keyword">let</span> controller = <span class="hljs-keyword">new</span> WordCounterController(wordCounter);

<span class="hljs-comment">// &#x6DFB;&#x52A0;&#x5230;&#x5F53;&#x63D2;&#x4EF6;&#x5173;&#x95ED;&#x65F6;&#x88AB;&#x6E05;&#x7406;&#x7684;&#x53EF;&#x6E05;&#x7406;&#x5217;&#x8868;</span>
context.subscriptions.push(controller);
context.subscriptions.push(wordCounter);
</code></pre>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5F53;<code>Markdown</code>&#x6587;&#x4EF6;&#x88AB;&#x6253;&#x5F00;&#x65F6;&#x52A0;&#x8F7D;&#x63D2;&#x4EF6;&#x3002;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4FEE;&#x6539;<code>package.json</code>&#x6587;&#x4EF6;&#x3002;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x7684;&#x63D2;&#x4EF6;&#x6FC0;&#x6D3B;&#x57FA;&#x4E8E;<code>extension.sayHello</code>&#x547D;&#x4EE4;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x4E0D;&#x9700;&#x8981;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;<code>package.json</code>&#x6587;&#x4EF6;&#x91CC;&#x5220;&#x9664;<code>contributes</code>&#x5C5E;&#x6027;&#x7684;&#x6761;&#x76EE;:</p>
<pre><code class="lang-json">    <span class="hljs-string">&quot;contributes&quot;</span>: {
        <span class="hljs-string">&quot;commands&quot;</span>:
            [{
                <span class="hljs-string">&quot;command&quot;</span>: <span class="hljs-string">&quot;extension.sayHello&quot;</span>,
                <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;Hello World&quot;</span>
            }
        ]
    },
</code></pre>
<p>&#x73B0;&#x5728;&#x6765;&#x4FEE;&#x6539;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#xFF0C;&#x901A;&#x8FC7;&#x66F4;&#x65B0;<code>activationEvents</code>&#x5C5E;&#x6027;&#x6765;&#x5B9E;&#x73B0;&#x5F53;&#x6253;&#x5F00;&#x4E00;&#x4E2A;<em>Markdown</em>&#x6587;&#x4EF6;&#x65F6;&#x6FC0;&#x6D3B;&#x63D2;&#x4EF6;&#xFF1A;</p>
<pre><code class="lang-json">    <span class="hljs-string">&quot;activationEvents&quot;</span>: [
        <span class="hljs-string">&quot;onLanguage:markdown&quot;</span>
    ]
</code></pre>
<p>&#x8FD9;&#x79CD;<a href="../../docs/extensionAPI/activation-events.md#activationeventsonlanguage"><code>onLanguage:${language}</code></a>&#x4E8B;&#x4EF6;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x8BED;&#x8A00;id&#xFF0C;&#x6B64;&#x5904;&#x662F;&#x201C;markdown&#x201D;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x5C06;&#x5728;&#x8FD9;&#x79CD;&#x8BED;&#x8A00;&#x7684;&#x6587;&#x4EF6;&#x88AB;&#x6253;&#x5F00;&#x65F6;&#x4EA7;&#x751F;&#x3001;&#x3001;</p>
<p>&#x901A;&#x8FC7;<code>kbstyle(Ctrl+R)</code>&#x6216;&#x8005;<code>kb(workbench.action.debug.start)</code>&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x7A97;&#x53E3;&#x6765;&#x8FD0;&#x884C;&#x63D2;&#x4EF6;&#x7136;&#x540E;&#x5F00;&#x59CB;&#x7F16;&#x8F91;&#x4E00;&#x4E2A;Markdown&#x6587;&#x4EF6;&#x3002;&#x4F60;&#x73B0;&#x5728;&#x5E94;&#x8BE5;&#x5DF2;&#x7ECF;&#x62E5;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x5B9E;&#x65F6;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;&#x3002;</p>
<p><img src="images/example-word-count/wordcountevent2.gif" alt="&#x4E8B;&#x4EF6;&#x89E6;&#x53D1;&#x65F6;&#x66F4;&#x65B0;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;"></p>
<p>&#x5982;&#x679C;&#x4F60;&#x5728;<code>activate</code>&#x51FD;&#x6570;&#x91CC;&#x8BBE;&#x7F6E;&#x4E86;&#x65AD;&#x70B9;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;Markdown&#x6587;&#x4EF6;&#x88AB;&#x6253;&#x5F00;&#x65F6;&#x4F60;&#x4F1A;&#x6536;&#x5230;&#x901A;&#x77E5;&#x3002;&#x90A3;&#x65F6;<code>WordCountController</code>&#x7C7B;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5C06;&#x4F1A;&#x8FD0;&#x884C;&#x5E76;&#x4E14;&#x8BA2;&#x9605;&#x7F16;&#x8F91;&#x5668;&#x7684;&#x4E8B;&#x4EF6;&#x4EE5;&#x4FBF;&#x4E8E;&#x5728;Markdown&#x6587;&#x4EF6;&#x88AB;&#x6253;&#x5F00;&#x6216;&#x8005;&#x5185;&#x5BB9;&#x88AB;&#x4FEE;&#x6539;&#x65F6;&#x8C03;&#x7528;<code>updateWordCount</code>&#x51FD;&#x6570;&#x3002; </p>
<p>Let&apos;s hook your helper class up to a set of events.</p>
<ul>
<li><code>onDidChangeTextEditorSelection</code> - Event is raised as the cursor position changes</li>
<li><code>onDidChangeActiveTextEditor</code> - Event is raised as the active editor changes.</li>
</ul>
<p>To do this, we&apos;ll add a new class into the <code>extension.ts</code> file. It will set up subscriptions to those events and ask the <code>WordCounter</code> to update the word count. Also note how this class manages the subscription as Disposables and how it stops listing when being disposed itself.</p>
<p>Add the <code>WordCounterController</code> as shown below to the bottom of the <code>extension.ts</code> file.</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WordCounterController</span> </span>{

    private _wordCounter: WordCounter;
    private _disposable: Disposable;

    <span class="hljs-keyword">constructor</span>(wordCounter: WordCounter) {
        <span class="hljs-keyword">this</span>._wordCounter = wordCounter;
        <span class="hljs-keyword">this</span>._wordCounter.updateWordCount();

        <span class="hljs-comment">// subscribe to selection change and editor activation events</span>
        <span class="hljs-keyword">let</span> subscriptions: Disposable[] = [];
        <span class="hljs-built_in">window</span>.onDidChangeTextEditorSelection(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);
        <span class="hljs-built_in">window</span>.onDidChangeActiveTextEditor(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);

        <span class="hljs-comment">// update the counter for the current file</span>
        <span class="hljs-keyword">this</span>._wordCounter.updateWordCount();

        <span class="hljs-comment">// create a combined disposable from both event subscriptions</span>
        <span class="hljs-keyword">this</span>._disposable = Disposable.from(...subscriptions);
    }

    dispose() {
        <span class="hljs-keyword">this</span>._disposable.dispose();
    }

    private _onEvent() {
        <span class="hljs-keyword">this</span>._wordCounter.updateWordCount();
    }
}
</code></pre>
<p>We no longer want the Word Count extension to be loaded when a command is invoked but instead be available for each <em>Markdown</em> file. </p>
<p>First, replace the body of the <code>activate</code> function with this:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Use the console to output diagnostic information (console.log) and errors (console.error).</span>
<span class="hljs-comment">// This line of code will only be executed once when your extension is activated.</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Congratulations, your extension &quot;WordCount&quot; is now active!&apos;</span>);

<span class="hljs-comment">// create a new word counter</span>
<span class="hljs-keyword">let</span> wordCounter = <span class="hljs-keyword">new</span> WordCounter();
<span class="hljs-keyword">let</span> controller = <span class="hljs-keyword">new</span> WordCounterController(wordCounter);

<span class="hljs-comment">// Add to a list of disposables which are disposed when this extension is deactivated.</span>
context.subscriptions.push(controller);
context.subscriptions.push(wordCounter);
</code></pre>
<p>Second, we must make sure the extension is activated upon the opening of a <code>Markdown</code> file.  To do this, we&apos;ll need to modify the <code>package.json</code> file.  Previously the extension was activated via the <code>extension.sayHello</code> command which we no longer need and so we can delete the entire <code>contributes</code> attribute from <code>package.json</code>:</p>
<pre><code class="lang-json">    <span class="hljs-string">&quot;contributes&quot;</span>: {
        <span class="hljs-string">&quot;commands&quot;</span>:
            [{
                <span class="hljs-string">&quot;command&quot;</span>: <span class="hljs-string">&quot;extension.sayHello&quot;</span>,
                <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;Hello World&quot;</span>
            }
        ]
    },
</code></pre>
<p>Now change your extension so that it is activated upon the opening of a <em>Markdown</em> file by updating the <code>activationEvents</code> attribute to this:</p>
<pre><code class="lang-json">    <span class="hljs-string">&quot;activationEvents&quot;</span>: [
        <span class="hljs-string">&quot;onLanguage:markdown&quot;</span>
    ]
</code></pre>
<p>The  <a href="../../docs/extensionAPI/activation-events.md#activationeventsonlanguage"><code>onLanguage:${language}</code></a> event takes the language id, in this case &quot;markdown&quot;, and will be raised whenever a file of that language is opened.</p>
<p>Run the extension by either doing a window reload <code>kbstyle(Ctrl+R)</code> or with <code>kb(workbench.action.debug.start)</code> and then start editing a Markdown file.  You should now should have a live updating Word Count.</p>
<p><img src="images/example-word-count/wordcountevent2.gif" alt="Word Count Updating on Events"></p>
<p>If you set a breakpoint on the <code>activate</code> function, you&apos;ll notice that it is only called once when the first Markdown file is opened.  The <code>WordCountController</code> constructor runs and subscribes to the editor events so that the <code>updateWordCount</code> function is called as Markdown files are opened and their text changes. </p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x72B6;&#x6001;&#x680F;--customizing-the-status-bar">&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x72B6;&#x6001;&#x680F;  Customizing the Status Bar</h2>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x4E86;&#x600E;&#x6837;&#x5728;&#x72B6;&#x6001;&#x680F;&#x4E0A;&#x663E;&#x793A;&#x683C;&#x5F0F;&#x5316;&#x7684;&#x6587;&#x5B57;&#x3002;VS Code&#x5141;&#x8BB8;&#x4F60;&#x81EA;&#x5B9A;&#x4E49;&#x72B6;&#x6001;&#x680F;&#xFF0C;&#x751A;&#x81F3;&#x8FDB;&#x4E00;&#x6B65;&#x589E;&#x52A0;&#x989C;&#x8272;&#x3001;&#x56FE;&#x6807;&#x3001;&#x5DE5;&#x5177;&#x63D0;&#x793A;&#x7B49;&#x7B49;&#x3002;&#x4F7F;&#x7528;&#x667A;&#x80FD;&#x63D0;&#x793A;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5F88;&#x591A;&#x79CD;<code>StartBarItem</code>&#x6210;&#x5458;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x5B66;&#x4E60;VS Code&#x63D2;&#x4EF6;API&#x7684;&#x597D;&#x65B9;&#x6CD5;&#x662F;&#x5305;&#x542B;&#x5728;&#x4F60;&#x751F;&#x6210;&#x7684;&#x63D2;&#x4EF6;&#x9879;&#x76EE;&#x91CC;&#x7684;<code>vscode.d.ts</code>&#x7C7B;&#x578B;&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x7F16;&#x8F91;&#x5668;&#x91CC;&#x6253;&#x5F00;<code>node_modules\vscode\vscode.d.ts</code>&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B8C;&#x6574;&#x7684;VS Code&#x63D2;&#x4EF6;API&#x548C;&#x6CE8;&#x91CA;&#x3002;</p>
<p><img src="images/example-word-count/vscode-d-ts.png" alt="vscode-d-ts&#x6587;&#x4EF6;"></p>
<p>&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6765;&#x66FF;&#x6362;StatusBarItem&#xFF1A;</p>
<pre><code class="lang-javascript">    <span class="hljs-comment">// &#x66F4;&#x65B0;&#x72B6;&#x6001;&#x680F;</span>
    <span class="hljs-keyword">this</span>._statusBarItem.text = wordCount !== <span class="hljs-number">1</span> ? <span class="hljs-string">`$(pencil) <span class="hljs-subst">${wordCount}</span> Words`</span> : <span class="hljs-string">&apos;$(pencil) 1 Word&apos;</span>;
    <span class="hljs-keyword">this</span>._statusBarItem.show();
</code></pre>
<p>&#x5728;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7684;&#x5DE6;&#x8FB9;&#x663E;&#x793A;&#x4E00;&#x4E2A;<a href="https://octicons.github.com" target="_blank">GitHub Octicon</a>&#x4E0A;&#x7684;<code>&#x94C5;&#x7B14;</code>&#x56FE;&#x6807;&#x3002;</p>
<p><img src="images/example-word-count/wordcount-pencil.png" alt="&#x5E26;&#x94C5;&#x7B14;&#x56FE;&#x6807;&#x7684;&#x5355;&#x8BCD;&#x6570;&#x7EDF;&#x8BA1;"></p>
<p>We&apos;ve seen how you can display formatted text on the Status Bar.  VS Code allows you to customize your Status Bar additions even further with color, icons, tooltips and more.  Using IntelliSense, you can see the various <code>StartBarItem</code> fields.  Another great resource for learning about the VS Code extensibility APIs is the <code>vscode.d.ts</code> typings file included in your generated Extension project.  Open <code>node_modules\vscode\vscode.d.ts</code> in the editor, you&apos;ll see the complete VS Code extensibility API with comments.</p>
<p><img src="images/example-word-count/vscode-d-ts.png" alt="vscode-d-ts file"></p>
<p>Replace the StatusBarItem update code with:</p>
<pre><code class="lang-javascript">    <span class="hljs-comment">// Update the status bar</span>
    <span class="hljs-keyword">this</span>._statusBarItem.text = wordCount !== <span class="hljs-number">1</span> ? <span class="hljs-string">`$(pencil) <span class="hljs-subst">${wordCount}</span> Words`</span> : <span class="hljs-string">&apos;$(pencil) 1 Word&apos;</span>;
    <span class="hljs-keyword">this</span>._statusBarItem.show();
</code></pre>
<p>to display a <a href="https://octicons.github.com" target="_blank">GitHub Octicon</a> <code>pencil</code> icon to the left of the calculated word count.</p>
<p><img src="images/example-word-count/wordcount-pencil.png" alt="Word Count with pencil icon"></p>
<h2 id="&#x9500;&#x6BC1;&#x63D2;&#x4EF6;&#x8D44;&#x6E90;--disposing-extension-resources">&#x9500;&#x6BC1;&#x63D2;&#x4EF6;&#x8D44;&#x6E90;  Disposing Extension Resources</h2>
<p>&#x6211;&#x4EEC;&#x5C06;&#x5728;<a href="../../docs/extensions/patterns-and-principles.md#disposables">&#x9500;&#x6BC1;</a>&#x91CC;&#x66F4;&#x6DF1;&#x5165;&#x7684;&#x800C;&#x5B66;&#x4E60;&#x5982;&#x4F55;&#x9500;&#x6BC1;&#x63D2;&#x4EF6;&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;&#x5728;&#x6FC0;&#x6D3B;&#x7684;&#x65F6;&#x5019;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x6709;Disposable&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x7684;<code>subscriptions</code>&#x7684;<code>ExtensionContext</code>&#x5BF9;&#x8C61;&#x3002;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#x53EF;&#x4EE5;&#x5411;&#x8FD9;&#x4E2A;&#x96C6;&#x5408;&#x4E2D;&#x6DFB;&#x52A0;&#x81EA;&#x5DF1;&#x7684;&#x53EF;&#x9500;&#x6BC1;&#x5BF9;&#x8C61;&#xFF0C;VS Code&#x5C06;&#x5728;&#x63D2;&#x4EF6;&#x5173;&#x95ED;&#x65F6;&#x9500;&#x6BC1;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x8BB8;&#x591A;&#x521B;&#x5EFA;&#x5DE5;&#x4F5C;&#x7A7A;&#x95F4;&#x6216;&#x8005;UI&#x5BF9;&#x8C61;&#x7684;VS Code&#x7684;API(&#x7C7B;&#x4F3C;<code>registerCommand</code>)&#x90FD;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;Disposable&#x5BF9;&#x8C61;&#xFF0C;&#x63D2;&#x4EF6;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x9500;&#x6BC1;&#x63A5;&#x53E3;&#x6765;&#x4ECE;VS Code&#x91CC;&#x79FB;&#x9664;&#x8FD9;&#x4E9B;&#x5143;&#x7D20;&#x3002;</p>
<p>Events are another example where <code>onDid*</code> event subscriber methods return a Disposable.  Extensions unsubscribe to an event by disposing the event&apos;s Disposable.  In our example, <code>WordCountController</code> handles the event subscription Disposables directly by keeping its own Disposable collection which it cleans up on deactivation.</p>
<pre><code class="lang-javascript">    <span class="hljs-comment">// &#x8BA2;&#x9605;&#x9009;&#x62E9;&#x533A;&#x57DF;&#x53D8;&#x5316;&#x548C;&#x7F16;&#x8F91;&#x5668;&#x6FC0;&#x6D3B;&#x4E8B;&#x4EF6;</span>
    <span class="hljs-keyword">let</span> subscriptions: Disposable[] = [];
    <span class="hljs-built_in">window</span>.onDidChangeTextEditorSelection(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);
    <span class="hljs-built_in">window</span>.onDidChangeActiveTextEditor(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);

    <span class="hljs-comment">// &#x4ECE;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x8BA2;&#x9605;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Disposable&#x7C7B;&#x578B;&#x7684;&#x96C6;&#x5408;</span>
    <span class="hljs-keyword">this</span>._disposable = Disposable.from(...subscriptions);
</code></pre>
<p>Now we&apos;ll take a deeper look at how extensions should handle VS Code resources through <a href="../../docs/extensions/patterns-and-principles.md#disposables">Disposables</a>.</p>
<p>When an extension is activated, it is passed an <code>ExtensionContext</code> object which has a <code>subscriptions</code> collection of Disposables. Extensions can add their Disposable objects to this collection and VS Code will dispose of those objects when the extension is deactivated.</p>
<p>Many VS Code APIs which create workspace or UI objects (e.g. <code>registerCommand</code>) return a Disposable and extensions can remove these elements from VS Code by calling their dispose method directly.</p>
<p>Events are another example where <code>onDid*</code> event subscriber methods return a Disposable.  Extensions unsubscribe to an event by disposing the event&apos;s Disposable.  In our example, <code>WordCountController</code> handles the event subscription Disposables directly by keeping its own Disposable collection which it cleans up on deactivation.</p>
<pre><code class="lang-javascript">    <span class="hljs-comment">// subscribe to selection change and editor activation events</span>
    <span class="hljs-keyword">let</span> subscriptions: Disposable[] = [];
    <span class="hljs-built_in">window</span>.onDidChangeTextEditorSelection(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);
    <span class="hljs-built_in">window</span>.onDidChangeActiveTextEditor(<span class="hljs-keyword">this</span>._onEvent, <span class="hljs-keyword">this</span>, subscriptions);

    <span class="hljs-comment">// create a combined disposable from both event subscriptions</span>
    <span class="hljs-keyword">this</span>._disposable = Disposable.from(...subscriptions);
</code></pre>
<h2 id="&#x672C;&#x5730;&#x5B89;&#x88C5;&#x4F60;&#x7684;&#x63D2;&#x4EF6;--installing-your-extension-locally">&#x672C;&#x5730;&#x5B89;&#x88C5;&#x4F60;&#x7684;&#x63D2;&#x4EF6;  Installing your Extension Locally</h2>
<p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x4F60;&#x5199;&#x7684;&#x63D2;&#x4EF6;&#x8FD0;&#x884C;&#x5728;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;of VS Code&#x5B9E;&#x4F8B;-&#x63D2;&#x4EF6;&#x5F00;&#x53D1;&#x4E3B;&#x673A;&#x5B9E;&#x4F8B;&#x3002;&#x4E3A;&#x4E86;&#x8BA9;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#x5BF9;&#x4E8E;&#x6240;&#x6709;&#x7684;VS Code&#x5B9E;&#x4F8B;&#x90FD;&#x80FD;&#x4F7F;&#x7528;&#xFF0C;&#x590D;&#x5236;&#x4F60;&#x7684;&#x63D2;&#x4EF6;&#x76EE;&#x5F55;&#x5185;&#x5BB9;&#x5230;&#x4E00;&#x4E2A;<a href="../../docs/extensions/install-extension.md#your-extensions-folder">&#x4F60;&#x7684;<code>.vscode/extensions</code>&#x76EE;&#x5F55;</a>&#x4E0B;&#x7684;&#x65B0;&#x76EE;&#x5F55;&#x3002;</p>
<p>So far, the extension you have written only runs in a special instance of VS Code, the Extension Development Host instance. To make your extension available to all VS Code instances, copy the extension folder contents to a new folder under <a href="../../docs/extensions/install-extension.md#your-extensions-folder">your <code>.vscode/extensions</code> folder</a>.</p>
<h2 id="&#x53D1;&#x5E03;&#x4F60;&#x7684;&#x63D2;&#x4EF6;--publishing-your-extension">&#x53D1;&#x5E03;&#x4F60;&#x7684;&#x63D2;&#x4EF6;  Publishing your Extension</h2>
<p>&#x9605;&#x8BFB;&#x600E;&#x6837;<a href="../../docs/tools/vscecli.md">&#x5171;&#x4EAB;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;</a>&#x3002;</p>
<p>Read about how to <a href="../../docs/tools/vscecli.md">Share an Extension</a>.</p>
<h2 id="&#x4E0B;&#x4E00;&#x6B65;--next-steps">&#x4E0B;&#x4E00;&#x6B65;  Next Steps</h2>
<p>&#x9605;&#x8BFB;&#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x6587;&#x6863;:</p>
<ul>
<li><a href="../../docs/tools/yocode.md">&#x751F;&#x6210;&#x4EE3;&#x7801;</a> - &#x5B66;&#x4E60;Yo Code&#x91CC;&#x7684;&#x5176;&#x4ED6;&#x9009;&#x9879;</li>
<li><a href="../../docs/extensionAPI/overview.md">&#x63D2;&#x4EF6;API</a> - &#x67E5;&#x770B;&#x63D2;&#x4EF6;API&#x6982;&#x8FF0;</li>
<li><a href="../../docs/customization/overview.md">&#x5B9A;&#x5236;&#x5316;</a> - &#x8FD9;&#x9898;&#xFF0C;&#x8BBE;&#x7F6E;&#x548C;&#x952E;&#x76D8;&#x7ED1;&#x5B9A;</li>
<li><a href="../../docs/tools/vscecli.md">&#x53D1;&#x5E03;&#x5DE5;&#x5177;</a> - &#x5B66;&#x4E60;&#x600E;&#x6837;&#x53D1;&#x5E03;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;&#x5230;&#x516C;&#x5171;&#x5E02;&#x573A;&#x91CC;</li>
<li><a href="../../docs/extensionAPI/vscode-api.md#window">&#x7F16;&#x8F91;&#x5668;API</a> - &#x5B66;&#x4E60;&#x66F4;&#x591A;&#x7684;&#x5173;&#x4E8E;&#x6587;&#x672C;&#x6587;&#x6863;&#xFF0C;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x548C;&#x7F16;&#x8F91;&#x6587;&#x672C;&#x7684;&#x77E5;&#x8BC6;</li>
</ul>
<p>Read on to find out about:</p>
<ul>
<li><a href="../../docs/tools/yocode.md">Yo Code</a> - learn about other options in Yo Code</li>
<li><a href="../../docs/extensionAPI/overview.md">Extension API</a> - Get an overview of the Extension API</li>
<li><a href="../../docs/customization/overview.md">Customization</a> - Themes, settings and keyboard bindings</li>
<li><a href="../../docs/tools/vscecli.md">Publishing Tool</a> - Learn how to publish an extension to the public Marketplace</li>
<li><a href="../../docs/extensionAPI/vscode-api.md#window">Editor API</a> - Learn more about Text Documents, Text Editors and editing text</li>
</ul>
<h2 id="&#x5E38;&#x89C1;&#x95EE;&#x9898;--common-questions">&#x5E38;&#x89C1;&#x95EE;&#x9898;  Common Questions</h2>
<p>&#x65E0;</p>
<p>Nothing yet</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="范例-hello-world.html" class="navigation navigation-prev " aria-label="Previous page: 范例-hello-world">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="范例-language-server.html" class="navigation navigation-next " aria-label="Next page: 范例-language-server">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"Order":3,"Area":"extensions","TOCTitle":"Example-Word Count","ContentId":"4D9132DC-CDDB-4E07-B2DD-9A7E168BE384","PageTitle":"Visual Studio Code Example - Word Count Extension","DateApproved":"4/14/2016","MetaDescription":"The Word Count extension (plug-in) example takes you deeper into the Visual Studio Code extensibility model, showing how to interact with the editor and manage extension and VS Code resources.","title":"范例-word-count","level":"1.9.3","depth":2,"next":{"title":"范例-language-server","level":"1.9.4","depth":2,"path":"md/扩展/范例-language-server.md","ref":"md/扩展/范例-language-server.md","articles":[]},"previous":{"title":"范例-hello-world","level":"1.9.2","depth":2,"path":"md/扩展/范例-hello-world.md","ref":"md/扩展/范例-hello-world.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","search-pro","intopic-toc","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"intopic-toc":{"isCollapsed":false,"isScrollspyActive":true,"label":"On This Page","maxDepth":6,"mode":"nested","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4, .markdown-section h5","visible":true},"search-pro":{},"livereload":{},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"VSCodeContributorsinChina","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"vscode-docs","language":"zh-hans","gitbook":"*"},"file":{"path":"md/扩展/范例-word-count.md","mtime":"2021-05-20T07:06:10.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-04-07T07:25:43.262Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-intopic-toc/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-intopic-toc/gumshoe.polyfills.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-intopic-toc/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

